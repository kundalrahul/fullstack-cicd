import psycopg2
from psycopg2 import sql

# Cloud SQL connection parameters
DB_USER = 'myuser'
DB_PASSWORD = 'mypassword'
DB_NAME = 'Test'
DB_HOST = '34.123.32.9'

def get_sql_connection():
    # Construct connection string
    conn_string = f"dbname={DB_NAME} user={DB_USER} password={DB_PASSWORD} host={DB_HOST}"

    # Connect to the database
    conn = psycopg2.connect(conn_string)

    return conn

def main():
    try:
        # Connect to the database
        conn = get_sql_connection()
        print("Connected to the database successfully!")

        # Create a cursor object using the connection
        cursor = conn.cursor()



# Commit the transaction
conn.commit()

        # Execute a sample SQL query
        cursor.execute("SELECT version();")

        # Fetch the query result
        db_version = cursor.fetchone()
        print("PostgreSQL database version:", db_version)

        # Close the cursor and connection
        cursor.close()
        conn.close()
        print("Connection closed.")

    except Exception as e:
        print(f"Error connecting to the database: {e}")

if __name__ == "__main__":
    main()
